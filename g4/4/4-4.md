# Домашнее задание к занятию «2.1. Системы хранения данных (СУБД)»



## Задание «PostgreSQL Authentication»

### Результаты выполнения задания

Пришлите в личном кабинете студента ответы на вопросы, указанные в разделе **«Выполнение»**:

1. Какие методы аутентификации используются для подключения по TCP/IP с адресов 127.0.0.1/32 и ::1/128?

   **Ответ:**

   Используются метод Trust, который позволяет подключиться под любым пользователем (ALL) к базе "replication".

2. Какие методы аутентификации используются для подключения по TCP/IP со всех остальных адресов, кроме указанных в предыдущем пункте по протоколу?

   **Ответ:**

   Для всех остальных подключений по TCP/IP используется медод MD5, что означает, что производится проверка пароля пользователя через аутентификацию SCRAM-SHA-256 или MD5. Пароли хранятся на сервере в зашифрованном виде, но это не защищает их в случае похищения, т.к. на сегодняшний день алгоритм MD5 не является надежным.

3. Верно ли утверждение: пароль роли `app` хранится в виде `функция_хеширования password` (пароль хранится в поле `rolpassword`)? Если не верно, то приведите описание алгоритма, который используется для хранения хеша.

   **Ответ:**

   Верно. В столбце rolpassword для роли app указано: md50d06d8eb2a5f36ab73d83481186543d5

   md5 - функция хэширования, далее следует 32 бита хэшированного пароля.

4. Какое значение имеют поля `rolsuper`, `rolcreaterole`, `rolcreatedb`, `rolbypassrls` с указанием назначения данных столбцов? `t` будет означать «да», `f` — «нет». См. https://postgrespro.ru/docs/postgresql/12/catalog-pg-authid.

   **Ответ:**

   - rolsuper -  роль имеет права суперпользователя
   - rolcreaterole -  роль может создавать другие роли
   -  rolecreatedb - роль может создавать базы данных
   - rolbypassrls - роль не подчиняется никаким политикам защиты на уровне строк

   Для роли app доступны все указанные выше разрешения.

5. Почему значения полей `rolcanlogin` и `rolpassword` для роли `app` не изменились, и вы по-прежнему можете подключиться с помощью `psql` без указания пароля, хотя в `pg_hba.conf` для `host all all all` указано `reject`?

   **Ответ:**

   1) Потому что подключение идет не через host, а локально. Поэтому было отработано правило из pg_hba.conf, которое дает доступ trust локально через сокет. Данное правило отработало и оставшиеся строки с доступами не рассматривались. По аналогии с правилами на межсетевых экранах. 

## Задание «CIS PostgreSQL Benchmarks»

1. Какие методы **не рекомендуется** использовать для удалённых подключений?

   **Ответ:**

   Методы trust, password и ident.

2. Какие методы **рекомендуется** использовать для удалённых подключений?

   **Ответ:**

   Рекомендуется использовать метод подключения с scram-sha-256, т.к. он является более надежнее, чем популярный MD5. Методы gss, sspi, pam, ldap, radius, и cert более надежны, но они не рассматриваются в данном бенчмарке.



## Задание «PostgreSQL ПРД»

### Результаты выполнения задания

Отправьте в личном кабинете студента сообщение, которое отображается вместо `???` в результате выполнения запросов с недостаточными правами доступа: `ERROR:  ???`.

**Ответ:** ERROR:  permission denied for table records